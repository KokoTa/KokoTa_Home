(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{305:function(t,a,s){"use strict";s.r(a);var n=s(14),e=Object(n.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"通信与安全"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通信与安全"}},[t._v("#")]),t._v(" 通信与安全")]),t._v(" "),a("p",[t._v("我：笨蛋测试，笨蛋测试！\n他：哔哔哔~，哔哔哔~\n我：你这个是什么意思？\n他：别BB~\n我：哔哔哔~，哔哔哔~")]),t._v(" "),a("h2",{attrs:{id:"通信"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通信"}},[t._v("#")]),t._v(" 通信")]),t._v(" "),a("h3",{attrs:{id:"同源策略与限制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#同源策略与限制"}},[t._v("#")]),t._v(" 同源策略与限制")]),t._v(" "),a("ol",[a("li",[t._v("源：协议+域名+端口，其中任何一项不同就是不同的源")]),t._v(" "),a("li",[t._v("同源策略：一个源的文件不能操作另一个源的文件，如：\n"),a("ul",[a("li",[t._v("Cookie、LocalStorage、IndexDB无法读取")]),t._v(" "),a("li",[t._v("DOM无法获得")]),t._v(" "),a("li",[t._v("Ajax请求不能发送")])])])]),t._v(" "),a("h3",{attrs:{id:"前后端如何通信"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前后端如何通信"}},[t._v("#")]),t._v(" 前后端如何通信")]),t._v(" "),a("ol",[a("li",[t._v("Ajax(受同源限制)")]),t._v(" "),a("li",[t._v("WebSocket(不受同源限制)")]),t._v(" "),a("li",[t._v("CORS(受不受限制都可以)")])]),t._v(" "),a("h3",{attrs:{id:"如何创建ajax"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#如何创建ajax"}},[t._v("#")]),t._v(" 如何创建Ajax")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/KokoTa/All-demo/blob/master/other/util.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("Ajax/Jsonp"),a("OutboundLink")],1)]),t._v(" "),a("h3",{attrs:{id:"跨域通信的几种方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#跨域通信的几种方式"}},[t._v("#")]),t._v(" 跨域通信的几种方式")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("JSONP")])]),t._v(" "),a("li",[a("p",[t._v("Hash")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 假设当前页面为A，A中利用iframe或frame嵌入了跨域的页面B，A包含B")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// A中代码：")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("B")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementsByTagName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'iframe'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("B")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("src "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("B")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("src "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'#'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'data'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// B中代码：")]),t._v("\nwindow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onhashchange")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" data "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("location"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 数据就在hash中")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("postMessage")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 假设页面A(http://A.com)向跨域的窗口B(http://B.com)发送信息")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// A中代码：")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("B")]),t._v("的窗口的window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("postMessage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'data'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://B.com'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// B中代码：")]),t._v("\nwindow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'message'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("functino")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("origin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("source"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("WebSocket(Socket.io)\n"),a("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2017/05/websocket.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考1"),a("OutboundLink")],1),t._v(" "),a("a",{attrs:{href:"http://blog.csdn.net/frank_good/article/details/50856585",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考2"),a("OutboundLink")],1)])]),t._v(" "),a("li",[a("p",[t._v("CORS(可以结合fetch使用)\n"),a("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2016/04/cors.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考"),a("OutboundLink")],1)])])]),t._v(" "),a("p",[t._v("额外链接：\n"),a("a",{attrs:{href:"https://segmentfault.com/a/1190000006669043",target:"_blank",rel:"noopener noreferrer"}},[t._v("聊聊Ajax那些事"),a("OutboundLink")],1),t._v(" "),a("a",{attrs:{href:"https://segmentfault.com/a/1190000011145364",target:"_blank",rel:"noopener noreferrer"}},[t._v("前端常见跨域解决方案"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"安全"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安全"}},[t._v("#")]),t._v(" 安全")]),t._v(" "),a("p",[t._v("他：网站的安全性不可忽略。\n我：是的，为了防止世界被破坏！\n他：为了维护...不对！安全方面的知识不能落下！\n我：(羞涩)\n他：滚！")]),t._v(" "),a("h3",{attrs:{id:"csrf-xsrf"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#csrf-xsrf"}},[t._v("#")]),t._v(" CSRF(XSRF)")]),t._v(" "),a("ol",[a("li",[t._v("概念：CSRF(Cross-site request forgery)，又称跨站请求伪造")]),t._v(" "),a("li",[t._v("攻击原理：如下图所示，首先我们登录了网站A，网站A认证之后返回 cookie 给用户。网站B是一个骗人网站，其中有一个诱导链接指向网站A(假设这个链接内容为 A 连接 + 查询信息)，当点击该链接跳转到网站A时会附带网站A的 cookie，此时若 cookie 中存在登录状态，那么就能以用户身份的进行查询。同理，img/script/iframe 等标签由于可以跨域获取资源，因此很容易发生 CSRF 问题，比如登录了网站A后访问了骗人网站B，网站B就可以使用这些标签，自动发送请求，省去了用户点击诱导连接这一步。")]),t._v(" "),a("li",[t._v("原因：网站A接口有漏洞；登录信息保存在cookie里，后端只通过cookie验证登录状态。")]),t._v(" "),a("li",[t._v("防御措施：\n"),a("ol",[a("li",[t._v("接口设定要区分清晰：因为大部分的CSRF是GET请求，所以我们的接口可以设置为“GET接口只获取资源，POST等接口操作资源”，但CSRF可以伪造POST请求，因此还需要搭配以下方法进行优化。")]),t._v(" "),a("li",[t._v("Token验证(csrfToken)：如果是GET请求，发送请求前手动添加token，即地址后加上?token=xxxx，后端验证token合法性；如果是POST请求，就在表单中增加一个隐形input，值为token，提交时一起传给后端验证。简而言之就是发送前需要手动添加验证信息，而不是无脑发送。")]),t._v(" "),a("li",[t._v("Referrer验证：判断请求的页面是否是在白名单中，是的话可以直接访问，不是的话则进行拦截。")]),t._v(" "),a("li",[t._v("隐藏令牌：类似token，就是token放置位置的区别，token从cookie中取出来放到HTTP的head中，CSRF无法操作cookie(或者也可以存储在localStorage中)。")]),t._v(" "),a("li",[t._v("阻止第三方网站请求接口\n"),a("img",{attrs:{src:"/images/CSRF.jpg",alt:"CSRF攻击原理"}}),t._v(" "),a("a",{attrs:{href:"https://github.com/astaxie/build-web-application-with-golang/blob/master/zh/09.1.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("其他资料"),a("OutboundLink")],1),t._v("\n一般来说都会设置 token 和 referrer，尤其是用在 jsonp 的 csrf 防御中，前者阻止了非法请求，后者阻止了非法来源。")])])])]),t._v(" "),a("h3",{attrs:{id:"xss"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#xss"}},[t._v("#")]),t._v(" XSS")]),t._v(" "),a("ol",[a("li",[t._v("概念：XSS(cross-site scripting)，又称跨域脚本攻击，一般来说浏览器会自动拦截XSS脚本")]),t._v(" "),a("li",[t._v("攻击原理：\n"),a("ol",[a("li",[t._v("反射型：发送 GET 请求时，XSS代码出现在URL中，作为输入提交到服务器端，服务器端解析后响应，XSS代码随响应内容一起传回浏览器，最后浏览器解析执行XSS代码")]),t._v(" "),a("li",[t._v("存储型：发送 POST 请求时，XSS代码出现在body中，提交的内容会存储在服务器端，下次请求目标页面时不再提交XSS代码")])])]),t._v(" "),a("li",[t._v("原因：用户数据未处理；客户端服务端不验证")]),t._v(" "),a("li",[t._v("防御措施：\n"),a("ol",[a("li",[t._v("编码：escape/encodeURI/encodeURIComponent 等")]),t._v(" "),a("li",[t._v("CSP：CSP 本质上就是建立白名单，开发者明确告诉浏览器哪些外部资源可以加载和执行。我们只需要配置规则，如何拦截是由浏览器自己实现的，设置方式：\n"),a("ol",[a("li",[a("p",[t._v("头信息设置")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("设置 HTTP Header 中的 Content-Security-Policy\n只允许加载本站资源\nContent-Security-Policy: default-src ‘self’\n只允许加载 HTTPS 协议图片\nContent-Security-Policy: img-src https://*\n允许加载任何来源框架\nContent-Security-Policy: child-src "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'none'")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("meta 标签设置\n"),a("code",[t._v('<meta http-equiv="Content-Security-Policy">')])])])])])])])]),t._v(" "),a("h3",{attrs:{id:"点击劫持"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#点击劫持"}},[t._v("#")]),t._v(" 点击劫持")]),t._v(" "),a("ol",[a("li",[t._v("概念：点击劫持是一种视觉欺骗的攻击手段")]),t._v(" "),a("li",[t._v("攻击原理：点击劫持是一种视觉欺骗的攻击手段。攻击者将需要攻击的网站通过 iframe 嵌套的方式嵌入自己的网页中，并将 iframe 设置为透明，在页面中透出一个按钮诱导用户点击")]),t._v(" "),a("li",[t._v("防御措施：设置 X-FRAME-OPTIONS 响应头\n"),a("ol",[a("li",[t._v("DENY，表示页面不允许通过 iframe 的方式展示")]),t._v(" "),a("li",[t._v("SAMEORIGIN，表示页面可以在相同域名下通过 iframe 的方式展示")]),t._v(" "),a("li",[t._v("ALLOW-FROM，表示页面可以在指定来源的 iframe 中展示")])])])])])}),[],!1,null,null,null);a.default=e.exports}}]);